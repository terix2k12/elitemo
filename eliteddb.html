<!DOCTYPE html>
<html>
 <head>
 	<title>Elite:Dangerous - Mission Optimizer</title>
 	<!-- script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script -->
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>

	<script>
  // Basic jQuery

$(document).ready(function() {
	
   $("#demo").html("Hello, World!");

  	var countries = [
   { value: 'Andorra', data: 'AD' },
   { value: 'Zimbabwe', data: 'ZZ' }
	];

$('#startSystem').autocomplete({
    source: countries
});


});
   /* onSelect: function (suggestion) {
        alert('You selected: ' + suggestion.value + ', ' + suggestion.data);
    }*/


	</script>
 </head>
 <body>
 	<h1>Elite:Dangerous - Mission Optimizer</h1>

<div id="jswarning">Your browsers needs to allow javascript for this page.</div>

<input type="file" id="files" name="files[]" multiple />
<output id="list"></output>

<button onclick="myFunction()">Click me</button>

<div id="demo">No jquery</div>


<form action="/action_page.php">
<datalist id="commoditiesDropdown">	
</datalist>
<datalist id="landingpadDropdown">
	<option value="S"></option>
	<option value="M"></option>
	<option value="L"></option>	
</datalist>
<datalist id="missionDropdown">	
	<option value="Delivery"></option>
	<option value="Source"></option>
	<option value="Intel"></option>
</datalist>

<div>
	<h2>General</h2>
	Cargohold: <input name="maxCargohold" type="number"> <br>
	Landingpad size: <input list="landingpadDropdown" name="landingpad"> <br>
	Jumprange (laden): <input name="maxJumprange" type="number"> <br>
	Max. hops from distance: <input name="maxHopDistance" type="number"> <br>
</div>
<div>
	System: <input id="startSystem" name="startSys" value="test">DUMMY</input> Station: <input name="startStation"> <br>

	<div>Missions:<br>
		<div>
			Type: <input list="missionDropdown" name="mission">
			Commodity: <input list="commoditiesDropdown" name="commodity">
			Target: <input name="commodity">
			Tonnes: <input name="commodity">
			Value: <input name="commodity">
		</div>
		<input type="submit" value="Add mission">
	</div>

	<div>Instructions:
		<ul>
			<li>Load xy tonnes of z
			<li>Unload xy tonnes of y
		</ul>
	</div>
</div>

<div>
	1st hop
</div>

<div>
	2nd hop
</div>

<div>
	last hop
</div>


	<input type="submit">
</form>

 	<script>

    var jswarning = document.getElementById("jswarning");
    jswarning.innerHTML = "JS active :) !";


 function myFunction() {
 	var xhttp = new XMLHttpRequest();
 	xhttp.onreadystatechange = function() {
		if (this.readyState == 4 && this.status == 200) {
			var resp = this.responseText;

			try {
    			var jsonArray = JSON.parse(resp );
    		} catch(e) {
    		    alert( e); 
    		}		
  	
  			var liste = [];

  			var dropdown = document.getElementById("commoditiesDropdown"); 
  			dropdown.innerHTML = '';

  			for( x in jsonArray) {
  				var item = jsonArray[x];
				dropdown.innerHTML += '<option data-id="'+item.id+'" value="'+ item.name +'"></option>';
  			} 			

    		 
    	}else{
    		// document.getElementById("demo").innerHTML = "Error on commodities receive " + this.readyState + " " + this.status;
    	}
  	};
  	xhttp.open("GET", "http://localhost:8000/commodities");
  	xhttp.send();
} 


// get most recent from https://eddb.io/archive/v6/stations.json

// infos about FileReader https://www.html5rocks.com/en/tutorials/file/dndfiles/


 document.getElementById('files').addEventListener('change', handleFileSelect, false);


function testApi() {
	// Check for the various File API support.
	if (!(window.File && window.FileReader && window.FileList && window.Blob)) {
  	alert('The File APIs are not fully supported in this browser.');
	} 
}

// Great success! All the File APIs are supported.


 
  function handleFileSelect(evt) {
  

    var files = evt.target.files; // FileList object

    // files is a FileList of File objects. List some properties.
    var output = [];
    for (var i = 0, f; f = files[i]; i++) {
      output.push('<li><strong>', escape(f.name), '</strong> (', f.type || 'n/a', ') - ',
                  f.size, ' bytes, last modified: ',
                  f.lastModifiedDate ? f.lastModifiedDate.toLocaleDateString() : 'n/a',
                  '</li>');
 

	var reader = new FileReader();
    reader.onload = function() {
 	     
 		var output = [];
 	 
       var jsonArray = JSON.parse(reader.result );//

        var firstElem = jsonArray[0];
        // output.push(firstElem.id);
       for( x in jsonArray) {
       	output.push( jsonArray[x].name );
  
         }

			document.getElementById('contents').innerHTML = output.join('');
       	};

 	reader.readAsText(f);

 }
    

    document.getElementById('list').innerHTML = '<ul>' + output.join(' # ') + '</ul>';
  }



  /*$("#ssstartSystem").autocomplete({
      source: function( request, response ) {
      	alert("jQuery begin");

        $.ajax({
          url: "/systems",
          dataType: "json",
          data: {
            q: request.term
          },
          success: function( data ) {
            response( data );
          }
        });
      },
      minLength: 3
      /*,
      select: function( event, ui ) {
        alert( ui.item ?
          "Selected: " + ui :
          "Nothing selected, input was " + this.value);
      },
      open: function() {
        $( this ).removeClass( "ui-corner-all" ).addClass( "ui-corner-top" );
      },
      close: function() {
        $( this ).removeClass( "ui-corner-top" ).addClass( "ui-corner-all" );
      }
    }
    );*/

</script>
  <div id="imprint">CMDR terix2k18 &copy; 2019</div>
 </body>
</html>